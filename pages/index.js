import { ApolloClient, InMemoryCache, gql } from '@apollo/client';
import Head from 'next/head'
import Hero from '../components/Hero';
import Logos from '../components/Logos';
import Services from '../components/Services';

export default function Home({ hero }) {

  return (
    <>
      <Head>
        <title>Weart.hu</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Hero data={hero} />
      <Logos data={hero} />
      <Services />
    </>
  )
}

export async function getStaticProps() {

  const client = new ApolloClient({
    uri: process.env.GQL_URL,
    cache: new InMemoryCache()
  });

  const { data } = await client.query({
    query: gql`query {
      pageBy(pageId: 1500) {
        homeHero {
          image {
            sourceUrl
          }
          text {
            lead
            title
          }
        }
      }
    }`
  })

  return {
    props: {
      hero: data.pageBy.homeHero
    }
  }
}